{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Minhas Conexões - Innovator</title>
  <link rel="stylesheet" href="{% static 'styles/conexao.css' %}">
</head>
<body>
  <nav>
    <div class="nav-left">
  <a href="{% url 'feed:home' %}"><img src="{% static 'assets/img/logo.png' %}" class="logo"></a>
      <ul>
      <li><img src="{% static 'assets/img/notification.png' %}"></li>
      <li><a href="{% url 'feed:mensagens' %}"><img src="{% static 'assets/img/inbox.png' %}" alt="Mensagens" style="cursor:pointer;"></a></li>
      </ul>
    </div>
    <div class="nav-right">
      <form class="search-box" method="get" action="">
        <img src="{% static 'assets/img/search.png' %}">
        <input type="text" name="q" placeholder="Pesquisar pessoas" value="{{ search_query|default:'' }}">
      </form>
    </div>
<div class="nav-user-icon online" onclick="settingsMenuToggle()">
  <img src="{{ request.user.get_profile_picture_url }}">
</div>

<!-- Bloco de configurações -->
<div class="settings-menu">
  <div id="dark-btn">
    <span></span>
  </div>

  <div class="settings-menu-inner">
    <div class="user-profile">
      <img src="{{ request.user.get_profile_picture_url }}">
      <div>
        <p>{{ request.user.fullname }}</p>
  <a href="{% url 'feed:perfil' %}">Ver Perfil</a>
      </div>
    </div>

    <hr>
    <div class="user-profile">
  <img src="{% static 'assets/img/feedback.png' %}">
      <div>
        <p>Nos dê seu feedback </p>
        <a href="#">Ajude a melhorar nosso site</a>
      </div>
    </div>
    <hr>

    <div class="settings-links">
  <img src="{% static 'assets/img/setting.png' %}" class="settings-icon">
      <a href="{% url 'feed:settings' %}">Configuração & Privacidade 
        <img src="{% static 'assets/img/arrow.png' %}" width="10px">
      </a>
    </div>

    <div class="settings-links">
  <img src="{% static 'assets/img/help.png' %}" class="settings-icon">
  <a href="#">Ajuda <img src="{% static 'assets/img/arrow.png' %}" width="10px"></a>
    </div>

    <div class="settings-links">
  <img src="{% static 'assets/img/logout.png' %}" class="settings-icon">
  <a href="{% url 'logout' %}">Sair <img src="{% static 'assets/img/arrow.png' %}" width="10px"></a>
    </div>
  </div>
</div>

    </div>
  </nav>

  <div class="container">
    <div class="left-sidebar">
      <style>
        .imp-links a {
          display: flex;
          align-items: center;
          padding: 10px 16px;
          border-left: 4px solid transparent;
          color: #256d4a !important;
          text-decoration: none;
          font-weight: 500;
          background: none;
          transition: background 0.2s, border-color 0.2s, color 0.2s;
        }
        .imp-links a.active {
          background: #eafaf1;
          border-left: 4px solid #28a745;
          color: #28a745 !important;
        }
        .imp-links a img {
          margin-right: 10px;
        }
      </style>
      <div class="imp-links">
        <a href="{% url 'feed:artigos' %}" class="{% if request.resolver_match.url_name == 'artigos' %}active{% endif %}"><img src="{% static 'assets/img/newspaper.png' %}"> Artigos Científicos</a>
        <a href="{% url 'feed:conexao' %}" class="{% if request.resolver_match.url_name == 'conexao' %}active{% endif %}"><img src="{% static 'assets/img/friends.png' %}"> Conexões</a>
        <a href="{% url 'feed:community' %}" class="{% if request.resolver_match.url_name == 'community' %}active{% endif %}"><img src="{% static 'assets/img/people.png' %}"> Comunidades</a>
      </div>
    </div>

<div class="main-content">
  <!-- Lista de pessoas seguidas -->
  <div class="post-container">
    <h3>Pessoas que você segue</h3>
    <div class="seguindo-lista">
      {% with seguidos=0 %}
        {% for user in users %}
          {% if user.id in following_ids %}
            {% ifchanged %}{% with seguidos=1 %}{% endwith %}{% endifchanged %}
            <div class="seguindo-item" id="seguindo-{{ user.id }}">
              <img src="{{ user.get_profile_picture_url }}">
              <p><a href="{% url 'feed:perfil' user.id %}" style="color: inherit; text-decoration: underline;">{{ user.fullname }}</a></p>
              <button type="button" class="seguir-link follow-btn following" data-url="{% url 'feed:toggle_follow' user.id %}">Deixar de Seguir</button>
            </div>
          {% endif %}
        {% endfor %}
        {% if not following_ids or not users|yesno:'1,0' %}
          <p>Você ainda não segue ninguém.</p>
        {% endif %}
      {% endwith %}
    </div>
  </div>

  <!-- Sugestões -->
  <div class="post-container">
    <h3>Sugestões para seguir</h3>
    <div class="sugestoes-grid">
      {% for user in users %}
        {% if user.id not in following_ids %}
          <div class="sugestao-card">
            <img src="{{ user.get_profile_picture_url }}">
            <h4><a href="{% url 'feed:perfil' user.id %}" style="color: inherit; text-decoration: underline;">{{ user.fullname }}</a></h4>
            <!-- username link to user profile -->
            {% if user.innovator_verification and user.innovator_verification.title %}
              <p>{{ user.innovator_verification.title }}</p>
            {% else %}
              <p>Leitor</p>
            {% endif %}
            <button type="button" class="seguir-link follow-btn" data-url="{% url 'feed:toggle_follow' user.id %}">Seguir</button>
          </div>
        {% endif %}
      {% empty %}
        <p>Nenhuma sugestão encontrada.</p>
      {% endfor %}
    </div>
  </div>
</div>


    <div class="right-sidebar">
      <div class="sidebar-title">
        <h4>Conversas</h4>
        <a href="#">Esconder conversa</a>
      </div>
      <div class="online-list">
        <div class="online"><img src="{% static 'assets/img/member-1.png' %}"></div>
        <p>Diva Luna</p>
      </div>
      <div class="online-list">
        <div class="online"><img src="{% static 'assets/img/member-2.png' %}"></div>
        <p>Lucas Brito</p>
      </div>
      <div class="online-list">
        <div class="online"><img src="{% static 'assets/img/member-3.png' %}"></div>
        <p>Leila Tales</p>
      </div>
    </div>
  </div>

  <script src="{% static 'js/home.js' %}"></script>
  <script src="{% static 'js/conexao.js' %}"></script>
</body>
</html>
