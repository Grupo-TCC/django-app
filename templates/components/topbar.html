{% load static %}
<!-- NAV -->
<nav class="topbar">
  <div class="nav-left">
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleMobileSidebar()" style="display: none;">
      <i class="bx bx-menu"></i>
    </button>
    
    <a href="{% url 'feed:artigos' %}"
      ><img src="{% static 'assets/img/logo.png' %}" class="logo"
    /></a>
    <ul class="hide-mobile">
      <li>
        <a href="{% url 'feed:mensagens' %}"
          ><img
            src="{% static 'assets/img/inbox.png' %}"
            alt="Mensagens"
            style="cursor: pointer"
        /></a>
      </li>
    </ul>
  </div>
  <div class="nav-right">
    <!-- Pesquisa removida da navbar -->
    <div class="nav-user-icon online" onclick="settingsMenuToggle()">
      <img src="{{ request.user.get_profile_picture_url }}" />
    </div>
    <div class="settings-menu">
      <div id="dark-btn"><span></span></div>
      <div class="settings-menu-inner">
        <div class="user-profile">
          <img src="{{ request.user.get_profile_picture_url }}" />
          <div>
            <p>{{ request.user.fullname }}</p>
            <a href="{% url 'feed:perfil' %}">Ver Perfil</a>
          </div>
        </div>
        <hr />
        <div class="user-profile">
          <img src="{% static 'assets/img/feedback.png' %}" />
          <div>
            <p>Nos dê seu feedback</p>
            <a href="#">Ajude a melhorar nosso site</a>
          </div>
        </div>
        <hr />
        <div class="settings-links">
          <img
            src="{% static 'assets/img/setting.png' %}"
            class="settings-icon"
          />
          <a href="{% url 'feed:settings' %}"
            >Configuração & Privacidade
            <img src="{% static 'assets/img/arrow.png' %}" width="10px"
          /></a>
        </div>
        <div class="settings-links">
          <img
            src="{% static 'assets/img/help.png' %}"
            class="settings-icon"
          />
          <a href="#"
            >Ajuda
            <img src="{% static 'assets/img/arrow.png' %}" width="10px"
          /></a>
        </div>
        <div class="settings-links">
          <img
            src="{% static 'assets/img/logout.png' %}"
            class="settings-icon"
          />
          <a href="{% url 'logout' %}"
            >Sair
            <img src="{% static 'assets/img/arrow.png' %}" width="10px"
          /></a>
        </div>
      </div>
    </div>
  </div>
</nav>

<!-- Mobile Overlay -->
<div class="mobile-sidebar-overlay" onclick="closeMobileSidebar()" style="display: none;"></div>

<script>
// Mobile Sidebar Functions
function toggleMobileSidebar() {
  const sidebar = document.querySelector('.left-sidebar');
  const overlay = document.querySelector('.mobile-sidebar-overlay');
  
  if (sidebar && overlay) {
    sidebar.classList.toggle('active');
    if (sidebar.classList.contains('active')) {
      overlay.style.display = 'block';
      document.body.style.overflow = 'hidden';
    } else {
      overlay.style.display = 'none';
      document.body.style.overflow = '';
    }
  }
}

function closeMobileSidebar() {
  const sidebar = document.querySelector('.left-sidebar');
  const overlay = document.querySelector('.mobile-sidebar-overlay');
  
  if (sidebar && overlay) {
    sidebar.classList.remove('active');
    overlay.style.display = 'none';
    document.body.style.overflow = '';
  }
}

// Close sidebar when clicking on a link (mobile)
document.addEventListener('DOMContentLoaded', function() {
  const sidebarLinks = document.querySelectorAll('.left-sidebar a');
  sidebarLinks.forEach(link => {
    link.addEventListener('click', function() {
      if (window.innerWidth <= 768) {
        closeMobileSidebar();
      }
    });
  });
  
  // Handle window resize
  window.addEventListener('resize', function() {
    if (window.innerWidth > 768) {
      closeMobileSidebar();
    }
  });
});
</script>

<style>
.mobile-sidebar-overlay {
  position: fixed;
  top: 60px;
  left: 0;
  width: 100%;
  height: calc(100vh - 60px);
  background: rgba(0, 0, 0, 0.5);
  z-index: 998;
}

@media (max-width: 768px) {
  .mobile-menu-toggle {
    display: block !important;
  }
}
</style>